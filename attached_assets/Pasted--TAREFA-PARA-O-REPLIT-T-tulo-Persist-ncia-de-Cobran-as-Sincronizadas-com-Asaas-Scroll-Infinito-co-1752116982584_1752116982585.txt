 TAREFA PARA O REPLIT
TÃ­tulo: PersistÃªncia de CobranÃ§as Sincronizadas com Asaas + Scroll Infinito com PaginaÃ§Ã£o no Front e Back

ğŸ¯ Objetivo
Persistir todas as cobranÃ§as sincronizadas com o Asaas no banco de dados, evitando perda de dados ao sair da tela.

Implementar scroll infinito com paginaÃ§Ã£o real no back-end e no front-end da listagem de cobranÃ§as.

ğŸ“Œ Parte 1 â€“ PersistÃªncia da SincronizaÃ§Ã£o com o Asaas
Problema Atual:
Atualmente, ao clicar em "Sincronizar com Asaas", o sistema carrega os dados diretamente da API e exibe na tela, mas nÃ£o salva no banco de dados. Ao sair da pÃ¡gina e voltar, os dados sÃ£o perdidos e a sincronizaÃ§Ã£o precisa ser refeita manualmente.

O que precisa ser feito:
No momento em que o botÃ£o "Sincronizar com Asaas" for clicado:

Buscar as cobranÃ§as da API do Asaas.

Salvar ou atualizar essas cobranÃ§as no banco de dados da aplicaÃ§Ã£o.

Armazenar a data e hora da Ãºltima sincronizaÃ§Ã£o para referÃªncia futura.

Quando a pÃ¡gina /cobrancas for carregada:

Listar as cobranÃ§as salvas localmente, a partir do banco de dados.

Executar a prÃ³xima sincronizaÃ§Ã£o apenas com as cobranÃ§as criadas ou alteradas apÃ³s a Ãºltima sincronizaÃ§Ã£o.

Banco de dados:
Criar ou atualizar a tabela payments com:

ts
Copiar
Editar
last_synced_at: timestamp
SugestÃ£o de lÃ³gica:
ts
Copiar
Editar
await fetchAsaasPayments({ since: lastSyncedAt }) // usar parÃ¢metro "startDate" se disponÃ­vel na API
BenefÃ­cios:
Evita chamadas desnecessÃ¡rias ao Asaas

Garante que as cobranÃ§as fiquem registradas de forma permanente

Melhora o desempenho da tela

ğŸ“Œ Parte 2 â€“ Scroll Infinito com PaginaÃ§Ã£o
Problema Atual:
A listagem de cobranÃ§as carrega tudo de uma vez, sem paginaÃ§Ã£o ou scroll eficiente. Isso:

Deixa o sistema mais lento conforme a base cresce

Ã‰ ruim para usabilidade e manutenÃ§Ã£o

O que precisa ser feito:
Back-end:
Atualizar o endpoint GET /api/asaas/payments para aceitar parÃ¢metros:

ts
Copiar
Editar
GET /api/asaas/payments?page=1&limit=30&status=pending
A resposta deve incluir:

ts
Copiar
Editar
{
  data: [array de cobranÃ§as],
  total: nÃºmero total de registros,
  hasNextPage: boolean
}
Front-end:
Implementar scroll infinito ou botÃ£o de "carregar mais" (preferÃªncia: scroll).

Sempre que o usuÃ¡rio chegar ao final da lista:

Disparar nova requisiÃ§Ã£o com page++

Concatenar os resultados no estado atual (setCharges([...charges, ...novosDados]))

Exibir loader ou skeleton temporÃ¡rio durante carregamento

ğŸ›¡ï¸ Regras Importantes
NÃ£o quebrar a funcionalidade atual de listagem e filtros.

A persistÃªncia e paginaÃ§Ã£o devem funcionar juntas.

O botÃ£o "Sincronizar com Asaas" continua visÃ­vel, mas agora ele atualiza o banco em vez de apenas preencher a tela.

âœ… Resultado Esperado
Ao clicar em â€œSincronizar com Asaasâ€, os dados sÃ£o salvos no banco

Ao acessar novamente a pÃ¡gina de cobranÃ§as, os dados jÃ¡ aparecem carregados do banco

A sincronizaÃ§Ã£o futura pega apenas as novas cobranÃ§as

A listagem suporta scroll infinito real, com paginaÃ§Ã£o back-end